# 常用字符串处理函数

## 1、可变参数宏

```c
    va_start(ap, v);
    va_arg(ap, t)
	...
    va_end(ap);
```
### 1.1、va_start
**声明**
```c 
typedef char* va_list;
#define va_start(list,param1)   ( list = (va_list)&param1+ sizeof(param1) )

void va_start(va_list ap, last_arg);
```
**参数**
- **ap** -- 这是一个 **va_list** 类型的对象，它用来存储通过 **va_arg** 获取额外参数时所必需的信息。
- **last_arg** -- 最后一个传递给函数的已知的固定参数。
当函数设置为
```c
void test(int num, param1, param2, param3, ...);
```
此时的**param1**等参数是在调用时进行设置。
### 1.2、va_arg(ap, t)
**声明**
```c
#define va_arg(list,mode)   ( (mode *) ( list += sizeof(mode) ) )[-1]
```
**参数**

- **list** -- list是类型为va_list的指针
- **mode** -- **mode**参数描述了当前参数的类型

### 1.3、va_end(ap)
**声明**
```c
#define va_end(list) ( list = (va_list)0 )
```
**参数**
- **list** -- **list**是类型为**va_list**的指针
清除list可变参数列表
### 1.4、demo
```c
#include<stdarg.h>  
#include<stdio.h>  

int sum(int, ...);  

int main(void)  
{  
    int a = 10;  
    printf("&a = %p\r\n", &a);  
    printf("10、20 和 30 的和 = %d\n",  sum(3, a, 20, 30) );  
    printf("4、20、25 和 30 的和 = %d\n",  sum(4, 4, 20, 25, 30) );  
    return 0;
}  

int sum(int num_args, ...)  
{  
    int val = 0;  
    va_list ap;  
    int i;  
    
    va_start(ap, num_args);  
    for(i = 0; i < num_args; i++)  
	    {  
		        val += va_arg(ap, int);  
		}  
    va_end(ap);  
    return val;  
}
```
### 1.5、现象

![image-20231031165429236](../images/image-20231031165429236.png)
## 2、strncmp()
### 2.1、描述
**strncmp()** 是一个标准库函数，用于比较两个字符串的前 **n** 个字符是否相等。
**strncmp()** 函数通常用于比较两个字符串，以确定它们是否相等或哪个字符串在字典顺序上更小。

### 2.2、声明
```c
int strncmp(const char *str1, const char *str2, size_t n)
```
- **str1 **-- 要比较的第一个字符串；
- **str2 **-- 要比较的第二个字符串；
- **n** -- 要比较的最大字符数；

返回值：
函数按字节进行比较；
- 如果返回值 < 0，则表示 str1 小于 str2。
- 如果返回值 > 0，则表示 str1 大于 str2。
- 如果返回值 = 0，则表示 str1 等于 str2。
### 2.3、实例
```c
#include<stdio.h>  
#include <string.h>  

int main()  
{  
    char *str1 = "789";  
    char *str2 = "012";  
    int ret1, ret2;  
    
    ret1 = strncmp(str1, str2, strlen(str1));  
    ret2 = !strncmp(str1, str2, strlen(str1));  
    printf("ret1 = %d, ret2 = %d\r\n", ret1, ret2);  
    return 0;  
}
```
返回值
```c
ret1 = 1, ret2 = 0
```

## 3、memcmp()
### 3.1、描述
把存储区 **str1** 和存储区 **str2** 的前 **n** 个字节进行比较；
注意：是对内存块中数据进行比较，内存块中的内容可以为**任何数据类型**；
### 3.2、声明
```c
int memcmp(const void *str1, const void *str2, size_t n)
```
- **str1**， **str2 **-- 指向内存块的指针；
- **n** -- 比较的字符串长度

返回值
由于函数是对内存块进行比较，所以是按字节进行比较。
- 如果返回值 < 0，则表示 str1 小于 str2。
- 如果返回值 > 0，则表示 str1 大于 str2。
- 如果返回值 = 0，则表示 str1 等于 str2。
### 3.3、实例
```c
#include<stdio.h>  
#include<stdlib.h>  
#include<string.h>  

int main()  
{  
	char *str1="789";  
	char *str2="012";  
	int ret1,ret2;  
	
	ret1 = memcmp(str1, str2, strlen(str1));  
	ret2 = !memcmp(str1, str2, strlen(str1));  
	printf("ret1 = %d, ret2 = %d\r\n", ret1, ret2);  
	return 0;  
}
```
返回值：
```c
ret1 = 1, ret2 = 0
```
## 4、strncpy()
### 4.1、描述
**strncpy()** 函数的功能是将指定字符串的前 n 个字符拷贝到另一个字符数组中。

### 4.2、声明
```c
char *strncpy(char *dest, const char *src, size_t n);
```
- **dest **-- 能存放字符的数组；
- **src **-- 源字符数组；
- **n** -- 复制的字符数；
返回值：
返回参数 **dest **的值，即返回一个指向存放 n 个字符的数组指针。
### 4.4、注意
1. 当**src**的长度小于n，则复制到**dest**中剩余部分，用空字符代替，凑齐n个字符；
2. 当**src**的长度大于n，则正常复制到**dest**，但是不会以**'\0**'结尾，如有需要，另外补上；
### 4.5、实例
```c
#include<stdio.h>  
#include<stdlib.h>  
#include<string.h>  


int main()  
{  
	const char *str1 = "abcdefg";  
	char *buf;
	
	strncpy(buf, str1, strlen(str1));  
	buf[strlen(str1) + 1] = '\0';  
	printf("buf = %s\r\n", buf);  
	printf("\r\n");  
	return 0;  
}
```

## 5、

